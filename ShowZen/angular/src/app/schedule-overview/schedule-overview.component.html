<div class="page-container">
  <!-- Header -->
  <div class="page-header">
    <div class="page-header-content">
      <div class="page-title-wrapper">
        <i class="far fa-calendar-alt page-icon d-none d-md-block"></i>
        <div>
          <h2 class="page-title">{{ '::ScheduleOverview' | abpLocalization }}</h2>
          <p class="page-subtitle">{{ scheduleData?.events?.length || 0 }} {{ '::Events' | abpLocalization }}</p>
        </div>
      </div>

      <div class="header-actions">
        <!-- View Switcher (hidden on mobile for now, defaults to list) -->
        <div class="btn-group me-3 d-none d-md-flex" role="group">
          <button type="button" class="btn btn-outline-secondary" [class.active]="currentView === ViewMode.List"
            (click)="onViewModeChange(ViewMode.List)" title="Lista">
            <i class="fa fa-list"></i>
          </button>
          <button type="button" class="btn btn-outline-secondary" [class.active]="currentView === ViewMode.Month"
            (click)="onViewModeChange(ViewMode.Month)" title="M√™s">
            <i class="fa fa-calendar-alt"></i>
          </button>
          <button type="button" class="btn btn-outline-secondary" [class.active]="currentView === ViewMode.Week"
            (click)="onViewModeChange(ViewMode.Week)" title="Semana">
            <i class="fa fa-calendar-week"></i>
          </button>
        </div>

        <button *abpPermission="'ShowZen.Events.Create'" class="btn btn-primary" (click)="onNewEvent()">
          <i class="fa fa-plus me-1"></i>
          <span class="d-none d-sm-inline">{{ '::NewEvent' | abpLocalization }}</span>
          <span class="d-sm-none">Novo</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Active Filters Summary (Mobile/Desktop) -->
  <div class="mb-3 d-flex flex-wrap gap-2 align-items-center" *ngIf="hasActiveFilters() || activePeriodLabel">
    <span class="text-muted small me-2">Filtros Ativos:</span>

    <!-- Period is always active really -->
    <span class="badge bg-light text-dark border">
      üìÖ {{ activePeriodLabel }}
    </span>

    <span class="badge bg-info text-white" *ngIf="activeArtistsLabel">
      üé§ {{ activeArtistsLabel }}
    </span>

    <span class="badge bg-success text-white" *ngIf="activeStatusesLabel">
      üìä {{ activeStatusesLabel }}
    </span>

    <span class="badge bg-warning text-dark" *ngIf="activeTypesLabel">
      üè∑Ô∏è {{ activeTypesLabel }}
    </span>
  </div>

  <!-- Filters (Desktop: card, Mobile: inline) -->
  <div class="d-none d-md-block">
    <div class="card mb-4">
      <div class="card-body p-3">
        <app-schedule-filters [artists]="artists" [filters]="filters" (filtersChange)="onFiltersChange($event)">
        </app-schedule-filters>
      </div>
    </div>
  </div>
  <div class="d-md-none mb-3">
    <app-schedule-filters [artists]="artists" [filters]="filters" (filtersChange)="onFiltersChange($event)">
    </app-schedule-filters>
  </div>

  <!-- Calendar/List View Card -->
  <div class="card">
    <div class="card-body p-0">
      <!-- Loading State -->
      <div *ngIf="loading" class="loading-overlay">
        <div class="spinner"></div>
        <p>{{ '::Loading' | abpLocalization }}...</p>
      </div>

      <!-- Calendar View (Month) -->
      <div class="calendar-wrapper" *ngIf="!loading && currentView === ViewMode.Month">
        <app-calendar-month [events]="scheduleData?.events || []"
          [dailyAvailability]="scheduleData?.dailyAvailability || {}" (eventClick)="onEventClick($event)"
          (dateClick)="onDateClick($event)">
        </app-calendar-month>
      </div>

      <!-- Calendar View (Week) -->
      <div class="calendar-wrapper" *ngIf="!loading && currentView === ViewMode.Week">
        <app-calendar-week [events]="scheduleData?.events || []" (eventClick)="onEventClick($event)">
        </app-calendar-week>
      </div>

      <!-- List View -->
      <div class="calendar-wrapper" *ngIf="!loading && currentView === ViewMode.List">
        <app-events-grid [events]="scheduleData?.events || []" (eventClick)="onEventClick($event)"></app-events-grid>
      </div>
    </div>
  </div>

  <app-conflict-alert [conflictsCount]="scheduleData?.conflictsCount || 0"></app-conflict-alert>

  <!-- Event Quick Modal -->
</div>