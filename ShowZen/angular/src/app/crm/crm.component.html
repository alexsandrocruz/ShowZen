<div class="row m-0 p-3 h-100 overflow-auto" style="min-height: calc(100vh - 80px);">
    <div class="col-12 d-flex gap-3 pb-3" cdkDropListGroup>

        <!-- Render Columns -->
        @for (col of columns; track col.status) {
        <div class="kanban-column bg-light rounded shadow-sm d-flex flex-column"
            style="min-width: 300px; max-width: 300px;">
            <!-- Header -->
            <div class="p-3 border-bottom bg-white rounded-top" [ngClass]="col.colorClass"
                style="border-top-width: 4px !important;">
                <div class="d-flex justify-content-between align-items-center mb-1">
                    <h6 class="mb-0 fw-bold">{{ col.title }}</h6>
                    <span class="badge bg-secondary rounded-pill">{{ col.items.length }}</span>
                </div>
                <div class="text-muted small">
                    Total: {{ getFeeTotal(col.items) | currency:'BRL' }}
                </div>
            </div>

            <!-- Drop List -->
            <div cdkDropList [cdkDropListData]="col.items" (cdkDropListDropped)="handleDrop($event, col.status)"
                class="flex-grow-1 p-2 kanban-list" style="min-height: 100px;">

                @for (item of col.items; track item.id) {
                <div class="card mb-2 shadow-sm kanban-card border-0" cdkDrag (click)="editEvent(item.id)"
                    style="cursor: pointer;">
                    <div class="card-body p-3">
                        <div class="d-flex justify-content-between mb-2">
                            <span class="badge bg-light text-dark border">{{ item.artistName }}</span>
                            <small class="text-muted">{{ item.startDateTime | date:'dd/MM' }}</small>
                        </div>
                        <h6 class="card-title mb-1 text-truncate" [title]="item.title">{{ item.title }}</h6>
                        <p class="card-text small text-muted mb-2 text-truncate">{{ item.clientName }}</p>

                        <div class="d-flex justify-content-between align-items-center mt-2 border-top pt-2">
                            <span class="fw-bold text-success">{{ item.fee | currency:'BRL' }}</span>
                            <i class="fa fa-user-circle text-muted"></i>
                        </div>
                    </div>
                </div>
                }

            </div>
        </div>
        }

    </div>
</div>

<app-event-quick-modal #eventQuickModal (onSave)="loadEvents()"></app-event-quick-modal>